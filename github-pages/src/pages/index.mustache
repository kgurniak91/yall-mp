<!-- HERO -->
<section class="hero">
  <div class="container hero-brand-area">
    <div class="hero-brand">
      <div class="brand-logo">
        <svg class="logo-svg"
             xmlns="http://www.w3.org/2000/svg" width="300pt" height="297pt"
             viewBox="0 0 300 297" preserveAspectRatio="xMidYMid meet">
          <g transform="translate(0,297) scale(0.1,-0.1)" stroke="none">
            <path fill="currentColor" fill-rule="evenodd"
                  d="M 1345 2822 C 1323 2812 1244 2767 1170 2723 C 1096 2679 884 2554 700 2445 C 516 2336 343.109 2237 325.109 2223 C 243.013 2173.374 245 2095 245 2095 L 245 1490 C 245 1490 231.213 1098.667 261.804 909.875 C 266.588 880.348 279.243 828.878 279.243 828.878 C 313.243 767.878 338 746 481 665 L 581 607 L 580 396 C 580 280 579 180 580 174 C 581 141 623 155 803 250 C 907 305 997 350 1002 350 C 1006 350 1034 335 1063 316 C 1309 158 1365 131 1437 130 C 1503 130 1509 133 1725 261 C 2281 590 2528 743 2557 776 C 2620 847 2620 842 2620 1490 C 2620 2142 2621 2136 2554 2203 C 2535 2222 2310.285 2375.457 2034.285 2539.457 C 2034.285 2539.457 1698.628 2745.907 1523.446 2818.198 C 1500.007 2827.87 1455.715 2839.429 1455.715 2839.429 C 1377.711 2842.858 1374 2836 1345 2822 Z
             M 1368 2475 C 1333 2462 1268 2427 1152 2357 C 1126 2342 1096 2325 1085 2320 C 1074 2314 1052 2301 1035 2290 C 1001 2268 896 2209 831 2174 C 806 2161 779 2144 771 2136 C 762 2129 731 2110 702 2095 C 673 2079 634 2049 615 2029 C 555 1962 553 1943 555 1460 C 557 976 554 998 627 929 C 662 896 730 852 790 822 C 815 810 833 800 880 768 C 894 759 933 737 965 719 C 998 701 1043 675 1065 661 C 1087 647 1119 629 1135 620 C 1178 597 1233 565 1277 537 C 1376 476 1454 466 1535 503 C 1563 516 1680 582 1795 650 C 1911 718 2014 779 2025 785 C 2036 791 2063 807 2085 822 C 2108 836 2150 860 2179 875 C 2207 890 2245 919 2261 939 C 2319 1007 2320 1015 2320 1491 C 2320 1491 2332.635 1939.355 2300.365 1979 C 2249.922 2040.971 2230 2066 2115 2131 C 2077 2153 2038 2175 2030 2180 C 1973 2216 1763.254 2333.237 1756.254 2340.237 C 1735.254 2361.237 1550 2460 1510 2473 C 1463 2488 1405 2489 1368 2475 Z
             M 1233 1878 C 1160.707 1902.86 1160 1831 1160 1831 L 1160 1495 C 1160 1162 1163 1128 1194 1108 C 1225 1087 1271 1108 1535 1264 C 1687 1355 1818 1434 1826 1441 C 1846 1457 1844 1514 1823 1532 C 1790 1560 1254.145 1870.729 1233 1878 Z">
            </path>
          </g>
        </svg>
      </div>

      <div class="brand-text">
        <div class="brand-breakdown">
          <span class="highlight">Y</span>et
          <span class="highlight">A</span>nother
          <span class="highlight">L</span>anguage
          <span class="highlight">L</span>earning
          <br>
          <span class="highlight">M</span>edia
          <span class="highlight">P</span>layer
        </div>
      </div>
    </div>
  </div>

  <div class="section-strip hero-strip">
    <div class="container">
      <h1 class="hero-title">
        {{{hero.title_start}}}
        <span class="txt-rotate"
              data-period="2000"
              data-rotate='{{hero.title_rotate_json}}'>
          {{hero.title_rotate_default}}
        </span>
        <br>{{{hero.title_end}}}
      </h1>
    </div>
  </div>

  <div class="container hero-content">
    <p class="hero-sub">
      <b><span class="highlight">Y'ALL</span> <span class="highlight">M</span>edia <span class="highlight">P</span>layer</b>
      {{{hero.description}}}
    </p>

    <div class="hero-actions">
      <a href="#workflow" class="btn btn-secondary">{{hero.btn_workflow}}</a>
      <a href="#download" class="btn btn-primary">{{hero.btn_download}}</a>
    </div>

    <div class="app-showcase">
      <img src="{{{rootPath}}}images/yall-mp-screenshot.png"
           alt="{{hero.screenshot_alt}}"
           width="1200"
           height="675"
           loading="eager">
    </div>

    <p class="screenshot-caption">
      {{{hero.screenshot_caption}}}
    </p>
  </div>
</section>

<!-- HOW IT WORKS -->
<section id="workflow" class="section-workflow">
  <div class="container">
    <div class="workflow-header">
      <h2>{{{workflow.header}}}</h2>
      <br>
      <p>{{{workflow.intro}}}</p>
      <ol>
        <li>{{{workflow.step1}}}</li>
        <li>{{{workflow.step2}}}</li>
        <li>{{{workflow.step3}}}</li>
        <li>{{{workflow.step4}}}</li>
        <li>{{{workflow.step5}}}</li>
      </ol>
    </div>

    <div class="workflow-row">
      <div class="workflow-text">
        <div class="workflow-title">
          <div class="workflow-icon">üé¨</div>
          <h3>{{workflow.feature_timeline.title}}</h3>
        </div>
        <p>{{{workflow.feature_timeline.desc}}}</p>
        <ul>
          {{#workflow.feature_timeline.list}}
            <li>{{{ . }}}</li>
          {{/workflow.feature_timeline.list}}
        </ul>
      </div>
      <div class="workflow-media">
        <div class="media-wrapper">
          <img src="{{{rootPath}}}images/features/feature-1.png"
               alt="{{workflow.feature_timeline.title}}"
               class="feature-img"
               loading="lazy">
        </div>
      </div>
    </div>

    <div class="workflow-row">
      <div class="workflow-text">
        <div class="workflow-title">
          <div class="workflow-icon">‚ö°</div>
          <h3>{{workflow.feature_playback.title}}</h3>
        </div>
        {{{workflow.feature_playback.desc_html}}}
      </div>
      <div class="workflow-media">
        <div class="media-wrapper">
          <img src="{{{rootPath}}}images/features/feature-2.png"
               alt="{{workflow.feature_playback.title}}"
               class="feature-img"
               loading="lazy">
        </div>
      </div>
    </div>

    <div class="workflow-row">
      <div class="workflow-text">
        <div class="workflow-title">
          <div class="workflow-icon">üîç</div>
          <h3>{{workflow.feature_dict.title}}</h3>
        </div>
        <p>{{{workflow.feature_dict.desc}}}</p>
        <ul>
          {{#workflow.feature_dict.list}}
            <li>{{{ . }}}</li>
          {{/workflow.feature_dict.list}}
        </ul>
        <p style="margin-top: 0.5rem;">
          <i class="highlight">{{{workflow.feature_dict.note}}}</i>
        </p>
      </div>
      <div class="workflow-media">
        <div class="media-wrapper">
          <img src="{{{rootPath}}}images/features/feature-3.png"
               alt="{{workflow.feature_dict.title}}"
               class="feature-img"
               loading="lazy">
        </div>
      </div>
    </div>

    <div class="workflow-row">
      <div class="workflow-text">
        <div class="workflow-title">
          <div class="workflow-icon">üß†</div>
          <h3>{{workflow.feature_anki.title}}</h3>
        </div>
        {{{workflow.feature_anki.desc_html}}}
      </div>
      <div class="workflow-media">
        <div class="media-wrapper">
          <img src="{{{rootPath}}}images/features/feature-4.png"
               alt="{{workflow.feature_anki.title}}"
               class="feature-img"
               loading="lazy">
        </div>
      </div>
    </div>

    <div class="workflow-row">
      <div class="workflow-text">
        <div class="workflow-title">
          <div class="workflow-icon">üéß</div>
          <h3>{{workflow.feature_presets.title}}</h3>
        </div>
        <p>{{{workflow.feature_presets.desc}}}</p>
        <ul>
          {{#workflow.feature_presets.list}}
            <li>{{{ . }}}</li>
          {{/workflow.feature_presets.list}}
        </ul>
      </div>
      <div class="workflow-media">
        <div class="media-wrapper">
          <img src="{{{rootPath}}}images/features/feature-5.png"
               alt="{{workflow.feature_presets.title}}"
               class="feature-img"
               loading="lazy">
        </div>
      </div>
    </div>

    <div class="workflow-row">
      <div class="workflow-text">
        <div class="workflow-title">
          <div class="workflow-icon">üöÄ</div>
          <h3>{{workflow.feature_progress.title}}</h3>
        </div>
        {{{workflow.feature_progress.desc_html}}}
      </div>
      <div class="workflow-media">
        <div class="media-wrapper">
          <img src="{{{rootPath}}}images/features/feature-6.png"
               alt="{{workflow.feature_progress.title}}"
               class="feature-img"
               loading="lazy">
        </div>
      </div>
    </div>

  </div>
</section>

<!-- DOWNLOAD -->
<section id="download" class="section-download">
  <div class="container download-inner">
    <h2>{{download.title}}</h2>
    <p class="download-sub">{{{download.subtitle}}}</p>

    <div class="download-box">
      <div class="os-section">
        <h3>{{download.win_title}}</h3>
        <a id="win-download-btn" href="https://github.com/kgurniak91/yall-mp/releases/latest" class="btn btn-large">
          <svg class="win-icon" viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor"
                  d="M0 3.449L9.75 2.1v9.451H0m10.949-9.602L24 0v11.4H10.949M0 12.6h9.75v9.451L0 20.699M10.949 12.6H24V24l-12.9-1.801"/>
          </svg>
          <span>{{download.win_btn}}</span>
        </a>
        <span class="version-info">{{download.win_info}}</span>
        <span id="version-text" class="version-number highlight">{{download.loading_text}}</span>
      </div>

      <div class="security-note">
        <div class="note-icon">‚ÑπÔ∏è</div>
        <div class="note-text">
          <b>{{download.smart_screen_title}}</b>
          <br>
          <a href="#faq-smartscreen">
            {{{download.smart_screen_link}}}
          </a>
        </div>
      </div>

      <div class="security-note">
        <div class="note-icon">üêû</div>
        <div class="note-text">
          <b>{{download.bug_report_title}}</b>
          <br>
          <a href="#faq-bugs">
            {{{download.bug_report_link}}}
          </a>
        </div>
      </div>

      <hr class="divider">

      <div class="os-section">
        <h3>{{download.other_title}}</h3>
        <p>
          {{{download.other_desc}}}
        </p>
        <a href="https://github.com/kgurniak91/yall-mp#installation" class="text-link">
          {{{download.other_link}}}
        </a>
      </div>
    </div>
  </div>
</section>

<!-- FAQ -->
<section id="faq" class="section-faq">
  <div class="container">
    <h2>{{faq_section_title}}</h2>
    {{#faq}}
      <div class="faq-item">
        <details {{#id}}id="{{id}}"{{/id}}>
          <summary>{{q}}</summary>
          <p>{{{a}}}</p>
        </details>
      </div>
    {{/faq}}
  </div>
</section>

<script>
  // Text Rotation
  class TxtRotate {
    constructor(el, toRotate, period) {
      this.toRotate = toRotate;
      this.el = el;
      this.loopNum = 0;
      this.period = parseInt(period, 10) || 2000;
      this.txt = '';
      this.isDeleting = false;
      this.tick();
    }

    tick() {
      let i = this.loopNum % this.toRotate.length;
      let fullTxt = this.toRotate[i];
      if (this.isDeleting) {
        this.txt = fullTxt.substring(0, this.txt.length - 1);
      } else {
        this.txt = fullTxt.substring(0, this.txt.length + 1);
      }
      this.el.innerHTML = '<span class="wrap">' + this.txt + '</span>';
      let delta = 200 - Math.random() * 100;
      if (this.isDeleting) {
        delta /= 2;
      }
      if (!this.isDeleting && this.txt === fullTxt) {
        delta = this.period;
        this.isDeleting = true;
      } else if (this.isDeleting && this.txt === '') {
        this.isDeleting = false;
        this.loopNum++;
        delta = 500;
      }
      setTimeout(() => this.tick(), delta);
    }
  }

  document.addEventListener('DOMContentLoaded', () => {
    let elements = document.getElementsByClassName('txt-rotate');
    for (let i = 0; i < elements.length; i++) {
      let toRotate = elements[i].getAttribute('data-rotate');
      let period = elements[i].getAttribute('data-period');
      if (toRotate) {
        new TxtRotate(elements[i], JSON.parse(toRotate), period);
      }
    }
  });

  // Fetch latest version from GitHub API
  fetch('https://api.github.com/repos/kgurniak91/yall-mp/releases/latest')
    .then(response => response.json())
    .then(data => {
      //  Update Version Text
      const versionSpan = document.getElementById('version-text');
      if (versionSpan) {
        versionSpan.innerText = data.tag_name;
      }

      // Find the .exe asset
      const winAsset = data.assets.find(asset => asset.name.endsWith('.exe'));

      if (winAsset) {
        const btn = document.getElementById('win-download-btn');
        if (btn) {
          btn.href = winAsset.browser_download_url;
        }
      }
    })
    .catch(err => {
      console.error("Failed to fetch latest release:", err);
    });

  // Auto-open FAQ details if targeted by URL hash
  document.addEventListener("DOMContentLoaded", () => {
    const handleHash = () => {
      if (window.location.hash) {
        const targetId = window.location.hash.substring(1);
        const targetElement = document.getElementById(targetId);
        if (targetElement && targetElement.tagName === 'DETAILS') {
          targetElement.open = true;
          // Optional: scroll into view
          targetElement.scrollIntoView({behavior: "smooth"});
        }
      }
    };

    handleHash();
    window.addEventListener('hashchange', handleHash);
  });
</script>
